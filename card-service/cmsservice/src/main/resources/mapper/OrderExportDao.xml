<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.wk.cms.dao.OrderExportDao">


    <!--//add-->
    <!--//delete-->
    <!--//get-->
    <update id="update" parameterType="com.wk.entity.OrderExport">
        UPDATE wk.wk_order_export SET update_time =  #{updateTime}
        <if test="orderId != null and orderId != '' ">, order_id = #{orderId} </if>
        <if test="exportDatae != null and exportDatae != '' ">, export_datae = #{ exportDatae} </if>
        <if test="type != null and type != 0 ">, type = #{type} </if>
        <if test="exportAccountId != null and exportAccountId != '' ">, export_account_id = #{ exportAccountId} </if>
        <if test="importAccountId != null and importAccountId != '' ">, import_account_id = #{ importAccountId} </if>
        <if test="cardPassword != null and cardPassword != '' ">, card_password = #{ cardPassword} </if>
        <if test="name != null and name != '' ">, name = #{name} </if>
        <if test="cardNumber != null and cardNumber != '' ">, card_number = #{ cardNumber} </if>
        <if test="importBill != null and importBill != '' ">, import_bill = #{ importBill} </if>
        <if test="rate != null and rate != '' ">, rate = #{rate} </if>
        <if test="fee != null and fee != '' ">, fee = #{fee} </if>
        <if test="remark != null and remark != '' ">, remark = #{remark} </if>
        <if test="seg != null and seg != '' ">, seg = #{seg} </if>
        <if test="optId != null and optId != '' ">, opt_id = #{ optId }</if>
        WHERE id=#{id}

    </update>



    <select id="search" resultType="com.wk.entity.OrderExport" parameterType="com.wk.entity.OrderExport">
        SELECT id,
        order_id orderId,
        export_datae exportDatae,
        type,
        export_account_id exportAccountId,
        import_account_id importAccountId,
        card_password cardPassword,
        name,
        card_number cardNumber,
        import_bill importBill,
        rate,
        fee,
        remark,
        seg,
        create_time createTime,
        update_time updateTime,
        opt_id optId  FROM wk.wk_order_export
        <where>
            <if test="orderId != null and orderId != '' ">AND  order_id = #{orderId} </if>
            <if test="exportDatae != null and exportDatae != '' ">AND  export_datae = #{ exportDatae} </if>
            <if test="type != null and type != 0 ">AND  type = #{type} </if>
            <if test="exportAccountId != null and exportAccountId != '' ">AND  export_account_id = #{ exportAccountId} </if>
            <if test="importAccountId != null and importAccountId != '' ">AND  import_account_id = #{ importAccountId} </if>
            <if test="cardPassword != null and cardPassword != '' ">AND  card_password = #{ cardPassword} </if>
            <if test="name != null and name != '' ">AND  name = #{name} </if>
            <if test="cardNumber != null and cardNumber != '' ">AND  card_number = #{ cardNumber} </if>
            <if test="importBill != null and importBill != '' ">AND  import_bill = #{ importBill} </if>
            <if test="rate != null and rate != '' ">AND  rate = #{rate} </if>
            <if test="fee != null and fee != '' ">AND  fee = #{fee} </if>
            <if test="remark != null and remark != '' ">AND  remark = #{remark} </if>
            <if test="seg != null and seg != '' ">AND  seg = #{seg} </if>
            <if test="optId != null and optId != '' ">AND  opt_id = #{ optId }</if>
            <if test=" startCreateTime != null and startCreateTime != '' "> create_time &gt; #{startCreateTime}</if>
            <if test=" endCreateTime != null and endCreateTime != '' "> create_time &lt; #{startCreateTime}</if>
            <if test=" startUpdateTime != null and startUpdateTime != '' "> update_time &gt; #{startUpdateTime}</if>
            <if test=" endUpdateTime != null and endUpdateTime != '' "> update_time &lt; #{endUpdateTime}</if>
            <if test="searchKey != null and searchKey != '' ">
                AND
                (
                cardNumber LIKE CONCAT(CONCAT('%', #{searchKey}),'%')
                OR
                phone LIKE CONCAT(CONCAT('%', #{searchKey}),'%')
                OR
                id_number LIKE CONCAT(CONCAT('%', #{searchKey}),'%')
                )
            </if>
        </where>  ORDER BY  update_time DESC  limit #{pageStart},#{pageSize}
    </select>


    <select id="searchCount" resultType="java.lang.Integer" parameterType="com.wk.entity.OrderExport">
        SELECT COUNT(*)   FROM wk.wk_order_export
        <where>
            <if test="orderId != null and orderId != '' ">AND  order_id = #{orderId} </if>
            <if test="exportDatae != null and exportDatae != '' ">AND  export_datae = #{ exportDatae} </if>
            <if test="type != null and type != 0 ">AND  type = #{type} </if>
            <if test="exportAccountId != null and exportAccountId != '' ">AND  export_account_id = #{ exportAccountId} </if>
            <if test="importAccountId != null and importAccountId != '' ">AND  import_account_id = #{ importAccountId} </if>
            <if test="cardPassword != null and cardPassword != '' ">AND  card_password = #{ cardPassword} </if>
            <if test="name != null and name != '' ">AND  name = #{name} </if>
            <if test="cardNumber != null and cardNumber != '' ">AND  card_number = #{ cardNumber} </if>
            <if test="importBill != null and importBill != '' ">AND  import_bill = #{ importBill} </if>
            <if test="rate != null and rate != '' ">AND  rate = #{rate} </if>
            <if test="fee != null and fee != '' ">AND  fee = #{fee} </if>
            <if test="remark != null and remark != '' ">AND  remark = #{remark} </if>
            <if test="seg != null and seg != '' ">AND  seg = #{seg} </if>
            <if test="optId != null and optId != '' ">AND  opt_id = #{ optId }</if>
            <if test=" startCreateTime != null and startCreateTime != '' "> create_time &gt; #{startCreateTime}</if>
            <if test=" endCreateTime != null and endCreateTime != '' "> create_time &lt; #{startCreateTime}</if>
            <if test=" startUpdateTime != null and startUpdateTime != '' "> update_time &gt; #{startUpdateTime}</if>
            <if test=" endUpdateTime != null and endUpdateTime != '' "> update_time &lt; #{endUpdateTime}</if>
            <if test="searchKey != null and searchKey != '' ">
                AND
                (
                cardNumber LIKE CONCAT(CONCAT('%', #{searchKey}),'%')
                OR
                phone LIKE CONCAT(CONCAT('%', #{searchKey}),'%')
                OR
                id_number LIKE CONCAT(CONCAT('%', #{searchKey}),'%')
                )
            </if>
        </where>
    </select>

</mapper>